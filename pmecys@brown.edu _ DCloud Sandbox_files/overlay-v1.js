(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(require("./render"),exports);__exportStar(require("./traverse"),exports)},{"./render":2,"./traverse":3}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.render=void 0;const render=(frame,dom,baseUri,cb)=>{const isDefined=item=>{return item!==undefined&&item!==null};class Renderer{constructor(dom){this.dom=dom}stringAt(idx){if(isDefined(idx)){return this.dom.strings[idx]}return""}nodeAt(idx){if(isDefined(idx)){return this.dom.nodes[idx]}return}ruleListAt(idx){if(isDefined(idx)){return this.dom.ruleLists[idx].real}return}renderTo(frame,source,baseUri,cb){const refs=new Map;const deferActions=[];const defer=act=>{deferActions.push(act)};const{contentDocument:doc}=frame;if(!doc){return}doc.open();const rendered=this.render(source,refs,doc,baseUri,defer);if(!rendered){return}switch(rendered.nodeType){case rendered.DOCUMENT_NODE:let renderedDoc=rendered;if(renderedDoc.doctype){doc.write(serialize(renderedDoc.doctype))}if(renderedDoc.documentElement){doc.appendChild(renderedDoc.documentElement)}break;default:doc.appendChild(rendered)}const style=doc.createElement("style");doc.head.appendChild(style);const styleSheet=doc.styleSheets[0];if(source.document){this.rulesFromStylesheets(source.document.styleSheets,styleSheet,baseUri)}setTimeout(()=>{deferActions.forEach(act=>{console.log("running deferred funcs");act()});const roots=[...doc.childNodes].filter(n=>n instanceof Element&&n.tagName&&n.tagName.toLowerCase()==="html");for(let i=1;i<roots.length;i++){doc.removeChild(roots[i])}frame.addEventListener("load",()=>cb({doc:doc,refs:refs}));doc.close()},1)}render(oneofNode,refs,context,baseUri,defer){if(!oneofNode){return}let childNodes=oneofNode.childNodes||[];if(oneofNode.element){const node=oneofNode.element;let localName=this.stringAt(node.localName);let attributes=(node.attributes||[]).map(a=>{return{localName:this.stringAt(a.localName),namespaceUri:this.stringAt(a.namespaceUri),prefix:this.stringAt(a.prefix),value:this.stringAt(a.value)}});if(localName==="style"||localName==="link"&&attributes.find(a=>a.localName==="rel"&&(a.value||"").toLowerCase()==="stylesheet")){localName+="-si-ignore";attributes.push({localName:"hidden",value:"true",namespaceUri:"",prefix:""})}let element;try{element=node.namespaceUri?context.createElementNS(this.stringAt(node.namespaceUri),localName):context.createElement(localName)}catch(err){const logTagNameError=(tagName,err)=>console.error(`Cannot create an element with tagName ${tagName}`,err);if(node.namespaceUri&&this.stringAt(node.namespaceUri)==="http://www.w3.org/1999/xhtml"){try{element=context.createElement(localName)}catch(err){logTagNameError(localName,err);return}}logTagNameError(localName,err);return}if(localName==="head"&&!childNodes.some(c=>{var _a;const el=(_a=this.nodeAt(c))===null||_a===void 0?void 0:_a.element;return el&&this.stringAt(el.localName)==="base"})){injectBaseUri(element,baseUri)}attributes.forEach(({localName,value,namespaceUri})=>{if(EVENT_ATTRIBUTE.test(localName)){return}switch(localName){case"target":if(value!=="_blank"){return}break;case"href":case"action":let url;try{url=new URL(value,baseUri)}catch(err){console.warn(err)}if(!url||url.protocol==="javascript:"){return}break;case"style":value=replaceWithResolvedURLs(value,baseUri);break}const apply=()=>{try{if(namespaceUri){element.setAttributeNS(namespaceUri,localName,value?value:"")}else{element.setAttribute(localName,value?value:"")}}catch(err){}};if(localName==="style"||localName==="src"||localName!=="base"&&localName==="href"){defer(apply)}else{apply()}});childNodes.forEach(child=>{const rendered=this.render(this.nodeAt(child),refs,context,baseUri,defer);if(rendered){element.appendChild(rendered)}});refs.set(oneofNode,element);let shadowRootNode=this.nodeAt(node.shadowRoot);if(shadowRootNode){let shadow=element.attachShadow({mode:"open"});let documentFragment=shadowRootNode.documentFragment;if(documentFragment&&documentFragment.shadowRoot){let shadowRoot=documentFragment.shadowRoot;const apply=()=>{let style=context.createElement("style");shadow.prepend(style);const sheet=shadow.styleSheets[0];this.rulesFromStylesheets(shadowRoot.styleSheets,sheet,baseUri)};defer(apply)}shadowRootNode.childNodes.forEach(child=>{const rendered=this.render(this.nodeAt(child),refs,context,baseUri,defer);if(rendered){shadow.appendChild(rendered)}})}let contentNode=this.nodeAt(node.content);if(contentNode){let template=element;contentNode.childNodes.forEach(child=>{const rendered=this.render(this.nodeAt(child),refs,context,baseUri,defer);if(rendered){template.content.appendChild(rendered)}})}return element}if(oneofNode.text){const text=context.createTextNode(this.stringAt(oneofNode.text.data));refs.set(oneofNode,text);return text}if(oneofNode.document){const type=childNodes.find(c=>{var _a;return!!((_a=this.nodeAt(c))===null||_a===void 0?void 0:_a.documentType)});const root=childNodes.find(c=>{const n=this.nodeAt(c);return(n===null||n===void 0?void 0:n.element)&&this.stringAt(n.element.localName)==="html"});const document=context.implementation.createDocument("","",type?this.render(this.nodeAt(type),refs,context,baseUri,defer):null);if(root){document.appendChild(this.render(this.nodeAt(root),refs,context,baseUri,defer))}return document}if(oneofNode.documentType){return context.implementation.createDocumentType(this.stringAt(oneofNode.documentType.name)||"html",this.stringAt(oneofNode.documentType.publicId),this.stringAt(oneofNode.documentType.systemId))}if(oneofNode.documentFragment){const fragment=context.createDocumentFragment();childNodes.forEach(child=>{const rendered=this.render(this.nodeAt(child),refs,context,baseUri,defer);if(rendered){fragment.appendChild(rendered)}});return fragment}}rulesFromStylesheets(styleSheets,target,baseUri){for(let i=0;i<styleSheets.length;i++){const s=styleSheets[i];if(!isDefined(s)){continue}if(s.media&&window.matchMedia&&!window.matchMedia(this.stringAt(s.media.mediaText)).matches){continue}if(!isDefined(s.cssRules)){continue}let ruleList=this.ruleListAt(s.cssRules);if(!isDefined(ruleList)){continue}let renderer=new RuleListRenderer(this,ruleList);renderer.renderTo(target,resolveURL(this.stringAt(s.href),baseUri))}}}const EVENT_ATTRIBUTE=/^on\w+/i;function serialize(node){switch(node.nodeType){case node.DOCUMENT_TYPE_NODE:let dtNode=node;return`<!DOCTYPE ${dtNode.name}`+(dtNode.publicId?` PUBLIC "${dtNode.publicId}"`:dtNode.systemId?" SYSTEM":"")+(dtNode.systemId?` "${dtNode.systemId}"`:"")+">";default:return node.outerHTML}}class RuleListRenderer{constructor(renderer,ruleset){this.ruleset=ruleset;this.renderer=renderer}stringAt(idx){if(isDefined(idx)){return this.ruleset.strings[idx]}return""}renderTo(target,baseUri){this.addRules(target,this.ruleset.cssRules,baseUri)}addRules(target,rules,baseUri){if(!rules){return}rules.forEach(r=>{var _a,_b,_c;const styleSheet=target;const index=target.cssRules.length;let ruleIndex;try{if(isDefined(r.styleRule)){styleSheet.insertRule(`${this.stringAt(r.styleRule.selectorText)} { ${replaceWithResolvedURLs(this.stringAt((_a=r.styleRule.style)===null||_a===void 0?void 0:_a.cssText),baseUri)} }`,index)}else if(isDefined(r.namespaceRule)){styleSheet.insertRule(`@namespace ${this.stringAt(r.namespaceRule.prefix)} url(${this.stringAt(r.namespaceRule.namespaceUri)})`,index)}else if(isDefined(r.importRule)){if(r.importRule.styleSheet){let ruleList=this.renderer.ruleListAt(r.importRule.styleSheet.cssRules);if(!isDefined(ruleList)){return}let renderer=new RuleListRenderer(this.renderer,ruleList);let target=styleSheet;ruleIndex=index;if(r.importRule.layerName){ruleIndex=target.insertRule(`@layer ${this.stringAt(r.importRule.layerName)} { }`,index);target=target.cssRules[ruleIndex];ruleIndex=0}if(r.importRule.media&&r.importRule.media.mediaText>0){ruleIndex=target.insertRule(`@media ${this.stringAt(r.importRule.media.mediaText)} { }`,ruleIndex);target=target.cssRules[ruleIndex]}renderer.renderTo(target,resolveURL(this.stringAt(r.importRule.href),baseUri))}}else if(isDefined(r.mediaRule)){ruleIndex=styleSheet.insertRule(`@media ${this.stringAt(r.mediaRule.conditionText)} { }`,index);this.addRules(styleSheet.cssRules[ruleIndex],r.mediaRule.cssRules||[],baseUri)}else if(isDefined(r.fontFaceRule)){styleSheet.insertRule(`@font-face { ${replaceWithResolvedURLs(this.stringAt((_b=r.fontFaceRule.style)===null||_b===void 0?void 0:_b.cssText),baseUri)} }`,index)}else if(isDefined(r.keyframesRule)){ruleIndex=styleSheet.insertRule(`@keyframes ${this.stringAt(r.keyframesRule.name)} {}`,index);this.addRules(styleSheet.cssRules[ruleIndex],r.keyframesRule.cssRules||[],baseUri)}else if(isDefined(r.keyframeRule)){target.appendRule(`${this.stringAt(r.keyframeRule.keyText)} { ${this.stringAt((_c=r.keyframeRule.style)===null||_c===void 0?void 0:_c.cssText)} }`)}else if(isDefined(r.supportsRule)){ruleIndex=styleSheet.insertRule(`@supports ${this.stringAt(r.supportsRule.conditionText)} { }`,index);this.addRules(styleSheet.cssRules[ruleIndex],[...r.supportsRule.cssRules],baseUri)}else if(isDefined(r.layerStatementRule)){styleSheet.insertRule(`@layer ${r.layerStatementRule.nameList.map(x=>this.stringAt(x)).join(",")};`)}else if(isDefined(r.layerBlockRule)){ruleIndex=styleSheet.insertRule(`@layer ${this.stringAt(r.layerBlockRule.name)} {}`,index);this.addRules(styleSheet.cssRules[ruleIndex],[...r.layerBlockRule.cssRules],baseUri)}else{console.warn(`unhandled type of CSSRule`,r)}}catch(e){console.warn(e,"Rule: ",r)}})}}function resolveURL(url,baseUri){try{return new URL(url,baseUri).href}catch(err){console.warn(err);return url}}const urlRx=/url\(\s*["']?([^\s"']+)["']?\s*\)/g;function replaceWithResolvedURLs(cssText,baseUri){if(!cssText){return cssText}return cssText.replace(urlRx,(substr,p1)=>{try{return substr.replace(p1,new URL(p1,baseUri).href)}catch(err){console.warn(err);return substr}})}function injectBaseUri(head,baseUri){head.innerHTML=`<base href="${baseUri}" />`}const renderer=new Renderer(dom);renderer.renderTo(frame,renderer.nodeAt(0),baseUri,cb)};exports.render=render},{}],3:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.traverse=void 0;const traverse=(root,options)=>{function isErrorWithMessage(error){return typeof error==="object"&&error!==null&&"message"in error&&typeof error.message==="string"}function toErrorWithMessage(maybeError){if(isErrorWithMessage(maybeError))return maybeError;try{return new Error(JSON.stringify(maybeError))}catch(_a){return new Error(String(maybeError))}}class Traverser{constructor(options){this.strings=[""];this.stringsIndex=new Map([["",0]]);this.nodes=[];this.ruleLists=[];this.errors=[];this.nodeLayoutMap={};this.options=options||{traverseIframes:false}}logError(err){const{message}=toErrorWithMessage(err);this.errors.push({message:message})}strIdx(v){if(!v){return 0}let idx=this.stringsIndex.get(v);if(idx){return idx}this.strings.push(v);idx=this.strings.length-1;this.stringsIndex.set(v,idx);return idx}addRuleList(r){this.ruleLists.push(r);return this.ruleLists.length-1}walk(node){const nextId=this.nodes.length;let n={};this.nodes.push(n);try{switch(node.nodeType){case 1:let{element,layout}=this.asElement(node);n.element=element;if(layout){this.nodeLayoutMap[nextId]=layout}break;case 3:n.text=this.asText(node);break;case 4:n.cdataSection=this.asCDATASection(node);break;case 8:n.comment=this.asComment(node);break;case 9:n.document=this.asDocument(node);break;case 10:n.documentType=this.asDocumentType(node);break;case 11:n.documentFragment=this.asDocumentFragment(node);break}}catch(err){this.logError(err)}n.childNodes=Array.from(node.childNodes).map(x=>this.walk(x));return nextId}getPropValue(element,proto,prop){const descriptor=Object.getOwnPropertyDescriptor(proto,prop);if(descriptor&&descriptor.get){return descriptor.get.call(element)}return null}asElement(element){let{namespaceURI,prefix,localName}=element;if(element instanceof HTMLFormElement){let proto=element;do{proto=Object.getPrototypeOf(proto)}while(proto!==null&&proto.constructor.name!=="Element");if(proto!==null){namespaceURI=this.getPropValue(element,proto,"namespaceURI");prefix=this.getPropValue(element,proto,"prefix");localName=this.getPropValue(element,proto,"localName")||""}}const attributes=[];for(let i=0,n=element.attributes.length;i<n;i++){const attr=element.attributes[i];attributes.push({localName:this.strIdx(attr.localName),value:this.strIdx(attr.value),prefix:this.strIdx(attr.prefix),namespaceUri:this.strIdx(attr.namespaceURI)})}let contentDocument=undefined;if(isElementWithTagName(element,"iframe")&&this.options.traverseIframes||isElementWithTagName(element,"object")){if(element.contentDocument!==null){contentDocument=this.walk(element.contentDocument)}}let content=undefined;if(isElementWithTagName(element,"template")){if(element.content!==null){content=this.walk(element.content)}}let shadowRoot=undefined;if(element.shadowRoot){shadowRoot=this.walk(element.shadowRoot)}let{x,y,width,height}=element.getBoundingClientRect();let rect={x:Math.round(x),y:Math.round(y),width:Math.round(width),height:Math.round(height)};let bcrLayout=undefined;if(rect.x===0&&rect.y===0&&rect.width===0&&rect.height===0){bcrLayout=undefined}else{bcrLayout={boundingClientRect:rect}}return{element:{namespaceUri:this.strIdx(namespaceURI),prefix:this.strIdx(prefix),localName:this.strIdx(localName),attributes:attributes,shadowRoot:shadowRoot,contentDocument:contentDocument,content:content},layout:bcrLayout}}asAttribute(attribute){const{namespaceURI,prefix,localName,value}=attribute;return{namespaceUri:this.strIdx(namespaceURI),prefix:this.strIdx(prefix),localName:this.strIdx(localName),value:this.strIdx(value)}}asText(text){let{data}=text;return{data:this.strIdx(data)}}asCDATASection(cdataSection){let{data}=cdataSection;return{data:this.strIdx(data)}}asComment(comment){let{data}=comment;return{data:this.strIdx(data)}}asDocument(document){return{styleSheets:this.getStyleSheets(document)}}asDocumentType(documentType){const{name,publicId,systemId}=documentType;return{name:this.strIdx(name),publicId:this.strIdx(publicId),systemId:this.strIdx(systemId)}}asDocumentFragment(documentFragment){var _a;let shadowRootType=((_a=documentFragment.ownerDocument.defaultView)===null||_a===void 0?void 0:_a.ShadowRoot)||ShadowRoot;if(documentFragment instanceof shadowRootType){return{shadowRoot:this.asShadowRoot(documentFragment)}}return{}}asShadowRoot(shadowRoot){return{mode:this.strIdx(shadowRoot.mode),styleSheets:this.getStyleSheets(shadowRoot)}}asStyleSheet(styleSheet,str){const{disabled,href,media:{mediaText}}=styleSheet;let ruleBuilder=new RuleBuilder(this);return{disabled:disabled,href:str.strIdx(href||""),cssRules:this.addRuleList(ruleBuilder.asRuleSet(styleSheet.cssRules)),media:{mediaText:str.strIdx(mediaText)}}}getStyleSheets(documentOrShadowRoot){const styleSheets=[];try{for(let i=0,n=documentOrShadowRoot.styleSheets.length;i<n;i++){try{styleSheets.push(this.asStyleSheet(documentOrShadowRoot.styleSheets[i],this))}catch(err){this.logError(err)}}if(documentOrShadowRoot.adoptedStyleSheets){for(let i=0;i<documentOrShadowRoot.adoptedStyleSheets.length;i++){try{styleSheets.push(this.asStyleSheet(documentOrShadowRoot.adoptedStyleSheets[i],this))}catch(err){this.logError(err)}}}}catch(err){this.logError(err)}return styleSheets}isAttribute(haystack,needle){return this.stringsIndex.get(needle)===haystack.localName}setAttribute(attributes,attribute,value=""){let attr={localName:this.strIdx(attribute),value:this.strIdx(value)};for(let i=0,n=attributes.length;i<n;i++){const found=attributes[i];if(this.isAttribute(found,attribute)){attributes[i]=attr;return null}}attributes.push(attr);return null}removeAttribute(attributes,attribute){for(let i=0,n=attributes.length;i<n;i++){const found=attributes[i];if(this.isAttribute(found,attribute)){attributes.splice(i,1);return true}}return false}toggleAttribute(attributes,attribute,present,value){if(present){this.setAttribute(attributes,attribute,value)}else{this.removeAttribute(attributes,attribute)}}persistElementState(element,attributes){if(isElementWithTagName(element,"input")){if(element.type==="radio"||element.type==="checkbox"){this.toggleAttribute(attributes,"checked",element.checked)}this.toggleAttribute(attributes,"value",element.value!=="",element.value)}else if(isElementWithTagName(element,"option")){this.toggleAttribute(attributes,"selected",element.selected)}else if(isElementWithTagName(element,"select")){this.removeAttribute(attributes,"value")}}}const isElementWithTagName=(element,tagName)=>{return element.namespaceURI==="http://www.w3.org/1999/xhtml"&&element.localName===tagName};class RuleBuilder{constructor(traverser){this.strings=[""];this.stringsIndex=new Map([["",0]]);this.nodes=[];this.traverser=traverser}strIdx(v){if(!v){return 0}let idx=this.stringsIndex.get(v);if(idx){return idx}this.strings.push(v);idx=this.strings.length-1;this.stringsIndex.set(v,idx);return idx}asRuleSet(rules){const cssRules=[];for(let i=0,n=rules.length;i<n;i++){try{const cssRule=this.asRule(rules[i]);if(cssRule!==null){cssRules.push(cssRule)}}catch(err){this.traverser.logError(err)}}return{real:{cssRules:cssRules,strings:this.strings}}}asStyleDeclaration(styleDeclaration){const{cssText}=styleDeclaration;return{cssText:this.strIdx(cssText)}}asRule(rule){var _a;const re=/CSS.*Rule/;const ruleName=(_a=rule.constructor.toString().match(re))===null||_a===void 0?void 0:_a[0];switch(ruleName){case"CSSStyleRule":return{styleRule:this.asStyleRule(rule)};case"CSSImportRule":return{importRule:this.asImportRule(rule)};case"CSSMediaRule":return{mediaRule:this.asMediaRule(rule)};case"CSSFontFaceRule":return{fontFaceRule:this.asFontFaceRule(rule)};case"CSSPageRule":return{pageRule:this.asPageRule(rule)};case"CSSKeyframesRule":return{keyframesRule:this.asKeyframesRule(rule)};case"CSSKeyframeRule":return{keyframeRule:this.asKeyframeRule(rule)};case"CSSNamespaceRule":return{namespaceRule:this.asNamespaceRule(rule)};case"CSSSupportsRule":return{supportsRule:this.asSupportsRule(rule)};case"CSSLayerBlockRule":return{layerBlockRule:this.asLayerBlockRule(rule)};case"CSSLayerStatementRule":return{layerStatementRule:this.asLayerStatementRule(rule)};default:this.traverser.logError(`CSSRule did not match any case. rule was: ${rule}`)}return null}asStyleRule(styleRule){const{selectorText}=styleRule;const style=this.asStyleDeclaration(styleRule.style);return{selectorText:this.strIdx(selectorText),style:style}}asImportRule(importRule){const{href,media:{mediaText},layerName}=importRule;const styleSheet=this.traverser.asStyleSheet(importRule.styleSheet,this);return{href:this.strIdx(href),media:{mediaText:this.strIdx(mediaText)},styleSheet:styleSheet,layerName:typeof layerName!=="undefined"&&layerName!==null?this.strIdx(layerName):undefined}}asMediaRule(mediaRule){const{conditionText}=mediaRule;const cssRules=[];for(let i=0,n=mediaRule.cssRules.length;i<n;i++){const cssRule=this.asRule(mediaRule.cssRules[i]);if(cssRule){cssRules.push(cssRule)}}return{cssRules:cssRules,conditionText:this.strIdx(conditionText)}}asFontFaceRule(fontFaceRule){const style=this.asStyleDeclaration(fontFaceRule.style);return{style:style}}asPageRule(pageRule){const{selectorText}=pageRule;const style=this.asStyleDeclaration(pageRule.style);return{selectorText:this.strIdx(selectorText),style:style}}asKeyframesRule(keyframesRule){const{name}=keyframesRule;const cssRules=[];for(let i=0,n=keyframesRule.cssRules.length;i<n;i++){const cssRule=this.asRule(keyframesRule.cssRules[i]);if(cssRule){cssRules.push(cssRule)}}return{name:this.strIdx(name),cssRules:cssRules}}asKeyframeRule(keyframeRule){const{keyText}=keyframeRule;const style=this.asStyleDeclaration(keyframeRule.style);return{keyText:this.strIdx(keyText),style:style}}asNamespaceRule(namespaceRule){const{namespaceURI,prefix}=namespaceRule;return{namespaceUri:this.strIdx(namespaceURI),prefix:this.strIdx(prefix)}}asSupportsRule(supportsRule){const{conditionText}=supportsRule;const cssRules=[];for(let i=0,n=supportsRule.cssRules.length;i<n;i++){const cssRule=this.asRule(supportsRule.cssRules[i]);if(cssRule){cssRules.push(cssRule)}}return{cssRules:cssRules,conditionText:this.strIdx(conditionText)}}asLayerBlockRule(layerBlockRule){const{name}=layerBlockRule;const cssRules=[];for(let i=0,n=layerBlockRule.cssRules.length;i<n;i++){const cssRule=this.asRule(layerBlockRule.cssRules[i]);if(cssRule){cssRules.push(cssRule)}}return{cssRules:cssRules,name:this.strIdx(name)}}asLayerStatementRule(layerStatementRule){const{nameList}=layerStatementRule;return{nameList:nameList.map(name=>this.strIdx(name))}}}const traverser=new Traverser(options);traverser.walk(root);return{dom:{nodes:traverser.nodes,strings:traverser.strings,ruleLists:traverser.ruleLists,errors:traverser.errors},layout:{version:1,documentLayout:{nodeLayoutMap:traverser.nodeLayoutMap}}}};exports.traverse=traverse},{}],4:[function(require,module,exports){(function(global){(function(){var traverse=require("@siteimprove/flat-object-model-capture/dist").traverse;global._si=global._si||[];(function(w,d,si,undefined){if(si.loaded){return}var state={requestUrl:"",currentInputtedUrl:"emptyurl",issues:0,position:"",mainLink:"",issuesLink:"",loginLink:"",isRechecking:false,error:false,errorReason:"",auth:false,isShown:false,token:"",isIframeOpen:false,isPfgListening:false,publishedPageUrl:"",timeout:null,cookie:{name:"sicmsplugin",domain:d.domain},minimized:false,stopPoll:false,isPageSpecific:false,isFirstPage:false,areRequestsAllowed:true,contentCheckCallback:null,highlightCallback:null,pollRequest:null,pollStartTime:null};var texts={issues:"Issues",buttonAriaLabel:"View issues",notFound:"Page not found",accessError:"Access error",recheck:"Rechecking...",regionName:"Siteimprove CMS Plugin",login:"Login",update:function(issues,notFound,recheck,buttonAriaLabel){texts.issues=issues||texts.issues;texts.notFound=notFound||texts.notFound;texts.recheck=recheck||texts.recheck;texts.buttonAriaLabel=buttonAriaLabel||texts.buttonAriaLabel}};var listeners={createClick:function(element,listener){if(element.addEventListener){element.addEventListener("click",listener)}else{element.attachEvent("onclick",listener)}},createMouseDown:function(element,listener){if(element.addEventListener){element.addEventListener("mousedown",listener)}else{element.attachEvent("onmousedown",listener)}},createMouseMove:function(element,listener){if(element.addEventListener){element.addEventListener("mousemove",listener)}else{element.attachEvent("onmousemove",listener)}},createMouseUp:function(element,listener){if(element.addEventListener){element.addEventListener("mouseup",listener)}else{element.attachEvent("onmouseup",listener)}},removeMouseDown:function(element,listener){if(element.removeEventListener){element.removeEventListener("mousedown",listener)}else{element.detachEvent("onmousedown",listener)}},removeMouseMove:function(element,listener){if(element.removeEventListener){element.removeEventListener("mousemove",listener)}else{element.detachEvent("onmousemove",listener)}},removeClick:function(element,listener){if(element.addEventListener){element.removeEventListener("click",listener)}else{element.detachEvent("onclick",listener)}}};var style={css:'@charset "utf-8"; .si-toggle-container {font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;position: fixed;display: block;background-color: transparent;z-index: 9999;}.si-toggle-container.si-pos-side {min-width: 6px;width: 54px;max-width: 54px;display: block;}.si-toggle-container.si-pos-bottom {min-height: 6px;height: 54px;max-height: 54px;display: block;}.si-toggle-container.si-pos-east {bottom: 50%;right: 1px;}.si-toggle-container.si-pos-south {left: 50%;bottom: 0;}.si-toggle-container.si-pos-east-south {right: 1px;bottom: 25%;}.si-toggle-container.si-pos-west-south {left: 1px;bottom: 25%;}.si-toggle-container.si-pos-west {left: 1px;bottom: 50%;}.si-toggle-container .si-button {border-width: 0;background-color: #fafafa;border-style: none;border-image: none;}.si-toggle-container .si-drag-container {display: inline-block;vertical-align: top;position: relative;}.si-toggle-container .si-drag-container.si-pos-side {height: 100%;width: 6px;}.si-toggle-container .si-drag-container.si-pos-bottom {height: 6px;width: 100%;vertical-align: bottom;display: block;}.si-toggle-container .si-drag-container .si-drag-box {display: block;position: absolute;}.si-toggle-container .si-drag-container .si-drag-box.si-pos-side {cursor: col-resize;width: 6px;height: 44px;top: 50px;margin-top: -22px;}.si-toggle-container .si-drag-container .si-drag-box.si-pos-side.cleared {top: 24px;}.si-toggle-container .si-drag-container .si-drag-box.si-pos-bottom {width: 44px;height: 6px;left: 50px;margin-left: -22px;cursor: row-resize;}.si-toggle-container .si-drag-container .si-drag-box.si-pos-bottom.cleared {left: 24px;}.si-toggle-container .si-drag-container .si-drag-box .si-drag-dots {border-radius: 10px 0 0 10px;background-color: #ededed;}.si-toggle-container .si-drag-container .si-drag-box .si-drag-dots.si-pos-bottom {border-radius: 10px 10px 0 0;width: 44px;height: 6px;}.si-toggle-container .si-drag-container .si-drag-box .si-drag-dots.si-pos-bottom:after {content: "\u2022\u2022\u2022";position: absolute;top: 33%;left: 50%;transform: translate(-50%, -50%);-webkit-transform: translate(-50%, -50%);-ms-transform: translate(-50%, -50%);-moz-transform: translate(-50%, -50%);font-size: 8px;letter-spacing: 2px;margin-left: 2px;}.si-toggle-container .si-drag-container .si-drag-box .si-drag-dots.si-pos-side {height: 44px;width: 6px;}.si-toggle-container .si-drag-container .si-drag-box .si-drag-dots.si-pos-side:after {content: "\u2022\u2022\u2022";position: absolute;top: 50%;left: 33%;transform: translate(-50%, -50%) rotate(90deg);-webkit-transform: translate(-50%, -50%) rotate(90deg);-ms-transform: translate(-50%, -50%) rotate(90deg);-moz-transform: translate(-50%, -50%) rotate(90deg);font-size: 8px;letter-spacing: 2px;margin-top: 2px;}.si-toggle-container .si-drag-container .si-drag-box .si-drag-dots.si-pos-east-south, .si-toggle-container .si-drag-container .si-drag-box .si-drag-dots.si-pos-east {border-radius: 10px 0 0 10px;}.si-toggle-container .si-drag-container .si-drag-box .si-drag-dots.si-pos-west-south, .si-toggle-container .si-drag-container .si-drag-box .si-drag-dots.si-pos-west {border-radius: 0 10px 10px 0;}.si-toggle-container .si-boxes-container {display: inline-block;overflow: hidden;background-color: #fff;box-shadow: 0 1px 16px rgba(0, 0, 0, 0.5);}.si-toggle-container .si-boxes-container.si-pos-side {width: 48px;max-width: 48px;}.si-toggle-container .si-boxes-container.si-pos-bottom {height: 48px;max-height: 48px;display: block;}.si-toggle-container .si-boxes-container .si-topbox {padding: 10px;display: block;}.si-toggle-container .si-boxes-container .si-topbox.si-pos-side {border-bottom: 1px solid #dddddd;}.si-toggle-container .si-boxes-container .si-topbox.si-pos-bottom {border-right: 1px solid #dddddd;display: table-cell;}.si-toggle-container .si-boxes-container .si-topbox > .si-button {display: block;background: none;width: 28px;height: 28px;}.si-toggle-container .si-boxes-container .si-topbox > .si-button.cleared > svg {opacity: 0.25;}.si-toggle-container .si-boxes-container .si-topbox > .si-button > svg {fill: #2dbce2;}.si-toggle-container .si-boxes-container .si-bottom-boxes {background-color: #fafafa;display: block;}.si-toggle-container .si-boxes-container .si-bottom-boxes.cleared {display: none;}.si-toggle-container .si-boxes-container .si-bottom-boxes.si-pos-bottom {display: table-cell;vertical-align: middle;}.si-toggle-container .si-boxes-container .si-bottom-boxes.si-pos-side {padding-bottom: 10px;}.si-toggle-container .si-boxes-container .si-bottom-boxes .si-login-box {color: #007a8f;text-decoration: none;text-align: center;vertical-align: middle;height: 48px;width: 48px;font-size: 12px;display: table-cell;text-overflow: ellipsis;overflow: hidden;}.si-toggle-container .si-boxes-container .si-bottom-boxes .si-circles-container {display: block;}.si-toggle-container .si-boxes-container .si-bottom-boxes .si-circles-container.si-pos-bottom {display: table;}.si-toggle-container .si-boxes-container .si-bottom-boxes .si-circles-container .si-single-circle-container {display: block;}.si-toggle-container .si-boxes-container .si-bottom-boxes .si-circles-container .si-single-circle-container.si-pos-bottom {display: table;height: 100%;}.si-toggle-container .si-boxes-container .si-bottom-boxes .si-circles-container .si-single-circle-container .si-circle-container {display: block;padding: 10px 0 0 0;text-align: center;max-width: 48px;}.si-toggle-container .si-boxes-container .si-bottom-boxes .si-circles-container .si-single-circle-container .si-circle-container.si-pos-bottom {min-width: 36px;padding: 0 0 0 2px;display: table-cell;vertical-align: middle;}.si-toggle-container .si-boxes-container .si-bottom-boxes .si-circles-container .si-single-circle-container .si-circle-container.si-pos-side {width: 48px;}.si-toggle-container .si-boxes-container .si-bottom-boxes .si-circles-container .si-single-circle-container .si-circle-container .si-single-circle {min-width: 10px;max-width: 48px;padding: 3px 7px;border-radius: 10px;display: inline-block;text-align: center;font-weight: 600;vertical-align: middle;white-space: nowrap;}.si-toggle-container .si-boxes-container .si-bottom-boxes .si-circles-container .si-single-circle-container .si-circle-container .si-single-circle.si-issues {background-color: #a93333;}.si-toggle-container .si-boxes-container .si-bottom-boxes .si-circles-container .si-single-circle-container .si-circle-container .si-single-circle.si-notifications {background-color: #008299;}.si-toggle-container .si-boxes-container .si-bottom-boxes .si-circles-container .si-single-circle-container .si-circle-container .si-single-circle.si-recheck {background-color: #eeeeee;}.si-toggle-container .si-boxes-container .si-bottom-boxes .si-circles-container .si-single-circle-container .si-circle-container .si-single-circle.si-recheck > div {width: 16px;height: 16px;display: inline-block;}.si-toggle-container .si-boxes-container .si-bottom-boxes .si-circles-container .si-single-circle-container .si-circle-container .si-single-circle.si-recheck > div > svg {fill: #696969;animation: si-rechecking 2s linear infinite;}.si-toggle-container .si-boxes-container .si-bottom-boxes .si-circles-container .si-single-circle-container .si-circle-container .si-single-circle > div {color: #fff;display: block;font-size: 12px;}.si-toggle-container .si-boxes-container .si-bottom-boxes .si-circles-container .si-single-circle-container .si-circle-container .si-single-circle > div.si-rechecking {width: 16px;height: 16px;display: inline-block;}.si-toggle-container .si-boxes-container .si-bottom-boxes .si-circles-container .si-single-circle-container .si-circle-container .si-single-circle > div.si-rechecking > svg {fill: #696969;animation: si-rechecking 2s linear infinite;}.si-toggle-container .si-boxes-container .si-bottom-boxes .si-circles-container .si-single-circle-container .si-circle-text-container {max-width: 36px;display: table;padding-top: 2px;margin: 0 auto;}.si-toggle-container .si-boxes-container .si-bottom-boxes .si-circles-container .si-single-circle-container .si-circle-text-container.si-pos-bottom {min-width: 36px;max-width: 100px;padding-top: 0;padding-right: 2px;display: table-cell;vertical-align: middle;}.si-toggle-container .si-boxes-container .si-bottom-boxes .si-circles-container .si-single-circle-container .si-circle-text-container.si-pos-side {width: 36px;}.si-toggle-container .si-boxes-container .si-bottom-boxes .si-circles-container .si-single-circle-container .si-circle-text-container > div {display: block;font-size: 10px;color: #222222;text-align: center;text-overflow: ellipsis;overflow: hidden;}.si-toggle-container .si-boxes-container .si-bottom-boxes .si-circles-container .si-single-circle-container .si-circle-text-container > div.si-pos-side {max-width: 36px;width: 36px;}.si-toggle-container article, .si-toggle-container aside, .si-toggle-container details, .si-toggle-container figcaption, .si-toggle-container figure, .si-toggle-container footer, .si-toggle-container header, .si-toggle-container hgroup, .si-toggle-container main, .si-toggle-container menu, .si-toggle-container nav, .si-toggle-container section, .si-toggle-container summary {display: block;padding: 0;margin: 0;}.si-toggle-container audio, .si-toggle-container canvas, .si-toggle-container progress, .si-toggle-container video {display: inline-block;vertical-align: baseline;padding: 0;margin: 0;}.si-toggle-container audio:not([controls]) {display: none;height: 0;}.si-toggle-container [hidden], .si-toggle-container template {display: none;}.si-toggle-container a {background-color: transparent;}.si-toggle-container div, .si-toggle-container button {padding: 0;margin: 0;}.si-toggle-container a:active, .si-toggle-container a:hover {outline: 0;}.si-toggle-container abbr[title] {border-bottom: 1px dotted;}.si-toggle-container b, .si-toggle-container strong {font-weight: bold;}.si-toggle-container dfn {font-style: italic;}.si-toggle-container h1 {font-size: 2em;margin: 0.67em 0;}.si-toggle-container mark {background: #ff0;color: #000;}.si-toggle-container small {font-size: 80%;}.si-toggle-container sub {font-size: 75%;line-height: 0;position: relative;vertical-align: baseline;}.si-toggle-container sup {font-size: 75%;line-height: 0;position: relative;vertical-align: baseline;top: -0.5em;}.si-toggle-container sub {bottom: -0.25em;}.si-toggle-container img {border: 0;}.si-toggle-container svg:not(:root) {overflow: hidden;}.si-toggle-container figure {margin: 1em 40px;}.si-toggle-container hr {box-sizing: content-box;height: 0;}.si-toggle-container pre {overflow: auto;}.si-toggle-container code, .si-toggle-container kbd, .si-toggle-container pre, .si-toggle-container samp {font-family: monospace, monospace;font-size: 1em;}.si-toggle-container button, .si-toggle-container input, .si-toggle-container optgroup, .si-toggle-container select, .si-toggle-container textarea {color: inherit;font: inherit;margin: 0;border: none;background: none;}.si-toggle-container button {overflow: visible;text-transform: none;}.si-toggle-container select {text-transform: none;}.si-toggle-container button, .si-toggle-container html input[type="button"] {-webkit-appearance: button;cursor: pointer;}.si-toggle-container input[type="reset"], .si-toggle-container input[type="submit"] {-webkit-appearance: button;cursor: pointer;}.si-toggle-container button[disabled], .si-toggle-container html input[disabled] {cursor: default;}.si-toggle-container button::-moz-focus-inner {border: 0;padding: 0;}.si-toggle-container input {line-height: normal;}.si-toggle-container input::-moz-focus-inner {border: 0;padding: 0;}.si-toggle-container input[type="checkbox"], .si-toggle-container input[type="radio"] {box-sizing: border-box;padding: 0;}.si-toggle-container input[type="number"]::-webkit-inner-spin-button, .si-toggle-container input[type="number"]::-webkit-outer-spin-button {height: auto;}.si-toggle-container input[type="search"] {-webkit-appearance: textfield;box-sizing: content-box;}.si-toggle-container input[type="search"]::-webkit-search-cancel-button, .si-toggle-container input[type="search"]::-webkit-search-decoration {-webkit-appearance: none;}.si-toggle-container fieldset {border: 1px solid #c0c0c0;margin: 0 2px;padding: 0.35em 0.625em 0.75em;}.si-toggle-container legend {border: 0;padding: 0;}.si-toggle-container textarea {overflow: auto;}.si-toggle-container optgroup {font-weight: bold;}.si-toggle-container table {border-collapse: collapse;border-spacing: 0;}.si-toggle-container td, .si-toggle-container th {padding: 0;}.si-iframe-container {position: fixed;z-index: 9999;background-color: transparent;height: 80%;min-height: 300px;max-width: 640px;min-width: 320px;width: 33%;display: block;border: 1px solid #bbb;overflow: hidden;border-radius: 4px;}.si-iframe-container.si-pos-east, .si-iframe-container.si-pos-east-south {text-align: right;}.si-iframe-container.si-pos-west, .si-iframe-container.si-pos-west-south {text-align: left;}.si-iframe-container.si-pos-west-south {top: 60%;left: 1px;}.si-iframe-container.si-pos-side {transform: translate(0, -50%);-webkit-transform: translate(0, -50%);-ms-transform: translate(0, -50%);-moz-transform: translate(0, -50%);}.si-iframe-container.si-pos-west {left: 1px;top: 50%;}.si-iframe-container.si-pos-east {right: 1px;top: 50%;}.si-iframe-container.si-pos-east-south {top: 60%;right: 1px;}.si-iframe-container.si-pos-south {left: 50%;bottom: 1px;transform: translate(-50%, 0);-webkit-transform: translate(-50%, 0);-ms-transform: translate(-50%, 0);-moz-transform: translate(-50%, 0);}.si-iframe-container .si-iframe-closer {position: absolute;height: 16px;width: 16px;top: 14px;right: 15px;z-index: 9999;cursor: pointer;}.si-iframe-container .si-iframe-closer > svg {fill: #555555;}.si-iframe-container .si-iframe-element {height: 100%;width: 100%;position: relative;border-width: 0;border-image: none;border-style: none;display: block;}@keyframes si-rechecking {to {-webkit-transform: rotate3d(0, 0, 1, 360deg);transform: rotate3d(0, 0, 1, 360deg);-moz-transform: rotate3d(0, 0, 1, 360deg);}}',siIcon:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" height="28px" width="28px" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 300 300" style="enable-background:new 0 0 300 300;" xml:space="preserve"><circle fill="#0D4CD3" cx="150" cy="150" r="150"/><g><path fill="#FFFFFF" d="M167.9,135.3l-14.3-4.2c-6.5-2-11.6-3.8-15.4-5.4c-3.8-1.6-6.5-3.4-8.1-5.2c-1.6-1.8-2.4-4.1-2.4-6.9 c0-3.4,1.1-6.3,3.2-8.7c2.1-2.5,5.1-4.4,9-5.7c3.8-1.3,8.3-2,13.5-2c5.2,0,10.4,0.7,15.6,2c5.2,1.3,9.9,3.2,14.3,5.5 c4.4,2.3,8,5.1,11,8.2l19-28.1c-6.5-6.3-15.1-11.2-25.7-14.8c-10.7-3.6-22.2-5.5-34.6-5.5c-9,0-17.3,1.3-24.9,3.8 c-7.6,2.5-14.2,6.1-19.9,10.7c-5.6,4.6-10,10-13.1,16.2c-3.1,6.2-4.7,13-4.7,20.3c0,11.4,3.7,21.2,11.1,29.3 c7.4,8.1,19.6,14.5,36.5,19.2l14.1,4c9.9,2.7,16.7,5.4,20.3,8.3c3.6,2.9,5.5,6.4,5.5,10.7c0,5.2-2.5,9.1-7.6,11.8 c-5,2.7-11.6,4-19.6,4c-5.7,0-11.6-0.7-17.6-2.2c-6.1-1.4-11.7-3.5-17.1-6.2c-5.3-2.7-9.7-5.8-13.1-9.5l-18.3,29.1 c8.1,7,18.1,12.3,29.8,15.9c11.7,3.7,23.8,5.5,36.2,5.5c13.4,0,24.9-2.2,34.6-6.7s17.2-10.6,22.6-18.6c5.3-7.9,8-17.1,8-27.5 c0-11.9-3.8-21.5-11.3-29C196.8,146.4,184.7,140.2,167.9,135.3z"/></g></svg>',recheckIcon:'<svg version="1.1" x="0px" y="0px" viewBox="0 0 135 123.8"><g><path class="st0" d="M67.1,12c-7.6,0-14.7,1.7-21.1,4.7L37,7.8C45.9,2.8,56.2,0,67.1,0C101.3,0,129,27.7,129,61.9 c0,8.7-1.8,16.9-5,24.4L135,97.4l-30.5,1.8l1.8-30.5l8.3,8.3c1.5-4.8,2.4-9.8,2.4-15.1C117,34.4,94.6,12,67.1,12z"/><path class="st0" d="M0,26.4l30.5-1.8l-1.8,30.5l-9-9c-1.7,4.9-2.6,10.2-2.6,15.7c0,27.5,22.4,49.9,49.9,49.9 c7.6,0,14.7-1.7,21.1-4.7l8.9,8.9c-8.9,5-19.2,7.8-30.1,7.8c-34.2,0-61.9-27.7-61.9-61.9c0-8.9,1.9-17.4,5.3-25L0,26.4z"/></g></svg>',closeIcon:'<svg version="1.1" x="0px" y="0px" viewBox="0 0 141.7 141.7"><polygon class="st0" points="141.7,15.5 126.2,0 70.9,55.4 15.5,0 0,15.5 55.4,70.9 0,126.2 15.5,141.7 70.9,86.4 126.2,141.7 141.7,126.2 86.4,70.9 "/></svg>',boxclass:{w:"si-pos-side",e:"si-pos-side",s:"si-pos-bottom",es:"si-pos-side",ws:"si-pos-side"},boxposition:{w:"si-pos-west",e:"si-pos-east",s:"si-pos-south",es:"si-pos-east-south",ws:"si-pos-west-south"},iframeElement:null,iframeContainer:null,containerElement:null,boxesElement:null,bottomBoxesElement:null,dragContainer:null,dragElement:null,recheckCircle:null,issuesCircle:null,issuesCircleContainer:null,mainButton:null,dragSize:6,_dragging:false,didDraggableMove:false,isDraggableElementAfterBoxes:function(){return style.isWest(state.position)},isWest:function(position){return position==="w"||position==="ws"},isEast:function(position){return position==="e"||position==="es"},isSouth:function(position){return position==="s"},getStylePropertyValue:function(element,property){return parseInt(window.getComputedStyle(element).getPropertyValue(property).slice(0,-2),10)},resizeSmallBoxContainer:function(e){if(!style.containerElement||!style.boxesElement){return}if(style.isEast(state.position)||style.isWest(state.position)){var width=e.pageX;if(style.isEast(state.position)){var w=document.documentElement.clientWidth||document.body.clientWidth;width=w-e.pageX}var maxWidth=style.getStylePropertyValue(style.boxesElement,"max-width")||100;if(maxWidth<width){width=maxWidth}else if(width<=1){width=0}style.containerElement.style.width=width+style.dragSize+"px";style.boxesElement.style.width=width+"px"}else if(style.isSouth(state.position)){var height=window.innerHeight-e.pageY;var maxHeight=style.getStylePropertyValue(style.boxesElement,"max-height")||100;if(maxHeight<height){height=maxHeight}else if(height<=1){height=0}height=style.containerElement.style.height=height+style.dragSize+"px";style.boxesElement.style.height=height+"px"}style.didDraggableMove=true},dragSmallBox:function(){if(style.containerElement&&style.boxesElement&&style.dragElement){style._dragging=true;listeners.createMouseMove(d,style.resizeSmallBoxContainer)}},maximizeSmallBox:function(){var size=(style.isSouth(state.position)?style.getStylePropertyValue(style.boxesElement,"max-height"):style.getStylePropertyValue(style.boxesElement,"max-width"))||100;if(style.isSouth(state.position)){style.containerElement.style.height=size+style.dragSize+"px";style.boxesElement.style.height=size+"px"}else{style.containerElement.style.width=size+style.dragSize+"px";style.boxesElement.style.width=size+"px"}style.dragElement.style.cursor="";state.minimized=false;listeners.createMouseDown(style.dragElement,style.dragSmallBox);listeners.removeClick(style.dragElement,style.maximizeSmallBox);core.setCookie(state.cookie.name,size,1e3,state.cookie.domain)},mouseUpListener:function(){if(style._dragging){listeners.removeMouseMove(d,style.resizeSmallBoxContainer);if(style.containerElement){if(!style.didDraggableMove){state.minimized=true;if(style.isSouth(state.position)){style.containerElement.style.height="0";style.boxesElement.style.height="0"}else{style.containerElement.style.width="0";style.boxesElement.style.width="0"}}style.didDraggableMove=false;var size=style.isSouth(state.position)?style.containerElement.offsetHeight:style.containerElement.offsetWidth;if(size<=10){listeners.removeMouseDown(style.dragElement,style.dragSmallBox);style.dragElement.style.cursor="pointer";setTimeout(function(){listeners.createClick(style.dragElement,style.maximizeSmallBox);state.minimized=true},100)}else{style.dragElement.style.cursor="";state.minimized=false}core.setCookie(state.cookie.name,size,1e3,state.cookie.domain);style._dragging=false}}},createDiv:function(className){var div=d.createElement("div");div.className+=className+" "+style.boxclass[state.position]+" "+style.boxposition[state.position];return div},createButton:function(className,link,buttonAriaLabel){var button=d.createElement("button");button.className+=className+" si-button ";button.setAttribute("data-link",link);if(buttonAriaLabel){button.setAttribute("aria-label",buttonAriaLabel)}listeners.createClick(button,style.openDataLinkUrl);return button},createLoginButton:function(){var button=style.createButton("si-login-box",state.loginLink,texts.login);button.textContent+=texts.login;return button},createDraggableElement:function(){var draggableContainer=style.createDiv("si-drag-container");var dragBox=style.createDiv("si-drag-box");var dotsBox=style.createDiv("si-drag-dots");dragBox.appendChild(dotsBox);draggableContainer.appendChild(dragBox);style.dragElement=dragBox;listeners.createMouseDown(style.dragElement,style.dragSmallBox);return draggableContainer},createBadge:function(circleName,badgeContent,text,link){var button=style.createButton("si-single-circle"+" "+circleName,link);button.setAttribute("aria-labelledby","numberOfIssuesInfo circleTextInfo");var buttonContent=style.createDiv("");buttonContent.innerHTML+=badgeContent;button.appendChild(buttonContent);button.setAttribute("id","numberOfIssuesInfo");var buttonContainer=style.createDiv("si-circle-container");buttonContainer.appendChild(button);var badgeDescriptionContainer=style.createDiv("si-circle-text-container");var badgeDescription=style.createDiv("",state.position);badgeDescription.setAttribute("id","circleTextInfo");badgeDescription.textContent+=text;badgeDescriptionContainer.appendChild(badgeDescription);var badgeContainer=style.createDiv("si-single-circle-container");badgeContainer.appendChild(buttonContainer);badgeContainer.appendChild(badgeDescriptionContainer);return badgeContainer},addBottomBoxContent:function(bottomBoxesElement,isAuthed,issues,isPageSpecific){if(!isAuthed){bottomBoxesElement.appendChild(style.createLoginButton())}else if(isPageSpecific){style.issuesCircleContainer=style.createDiv("si-circles-container");var badge;if(state.isRechecking){badge=style.createBadge("si-recheck",style.recheckIcon,texts.recheck,"");style.recheckCircle=badge}else{var errorText=state.errorReason=="noaccess"?texts.accessError:texts.notFound;badge=style.createBadge("si-issues",state.error?"!":issues,state.error?errorText:texts.issues,state.issuesLink);style.issuesCircle=badge}style.issuesCircleContainer.appendChild(badge);bottomBoxesElement.appendChild(style.issuesCircleContainer)}},createSmallBox:function(isAuthed,issues,isPageSpecific){var mainContainer=style.createDiv("si-toggle-container");mainContainer.setAttribute("role","region");mainContainer.setAttribute("aria-label",texts.regionName);var boxesContainer=style.createDiv("si-boxes-container");var topbox=style.createDiv("si-topbox");var iconContainer=style.createButton("",state.mainLink,texts.buttonAriaLabel);iconContainer.innerHTML+=style.siIcon;style.mainButton=iconContainer;topbox.appendChild(iconContainer);boxesContainer.appendChild(topbox);var bottomBoxesElement=style.createDiv("si-bottom-boxes");style.addBottomBoxContent(bottomBoxesElement,isAuthed,issues,isPageSpecific);style.bottomBoxesElement=bottomBoxesElement;boxesContainer.appendChild(bottomBoxesElement);style.dragContainer=style.createDraggableElement();if(style.isDraggableElementAfterBoxes(state.position)){mainContainer.appendChild(boxesContainer);mainContainer.appendChild(style.dragContainer)}else{mainContainer.appendChild(style.dragContainer);mainContainer.appendChild(boxesContainer)}style.containerElement=mainContainer;style.boxesElement=boxesContainer;listeners.createMouseUp(w,style.mouseUpListener);return mainContainer},createStyleElement:function(){var styleElement=d.createElement("style");styleElement.type="text/css";styleElement.innerHTML=style.css;return styleElement},updateSmallBoxScreenPosition:function(oldPosition,newPosition){if(!style.containerElement){return}var elements=style.containerElement.querySelectorAll("."+style.boxposition[oldPosition]);for(var i=0;i<elements.length;i++){elements[i].className=elements[i].className.replace(style.boxposition[oldPosition],style.boxposition[newPosition]).replace(style.boxclass[oldPosition],style.boxclass[newPosition])}if(style.isSouth(oldPosition)&&!style.isSouth(newPosition)){style.containerElement.style.width=style.containerElement.style.height;style.boxesElement.style.width=style.boxesElement.style.height;style.containerElement.style.height="";style.boxesElement.style.height=""}else if(style.isSouth(newPosition)&&!style.isSouth(oldPosition)){style.containerElement.style.height=style.containerElement.style.width;style.boxesElement.style.height=style.boxesElement.style.width;style.containerElement.style.width="";style.boxesElement.style.width=""}style.containerElement.className=style.containerElement.className.replace(style.boxposition[oldPosition],style.boxposition[newPosition]).replace(style.boxclass[oldPosition],style.boxclass[newPosition]);if(style.isEast(oldPosition)&&style.isWest(newPosition)||style.isSouth(oldPosition)&&style.isWest(newPosition)){style.containerElement.removeChild(style.dragContainer);style.containerElement.appendChild(style.dragContainer)}else if(style.isEast(newPosition)&&style.isWest(oldPosition)||style.isSouth(newPosition)&&style.isWest(oldPosition)){style.containerElement.removeChild(style.dragContainer);style.containerElement.insertBefore(style.dragContainer,style.containerElement.firstChild)}if(style.iframeContainer&&style.iframeElement){style.iframeContainer.className=style.iframeContainer.className.replace(style.boxposition[oldPosition],style.boxposition[newPosition]).replace(style.boxclass[oldPosition],style.boxclass[newPosition]);style.iframeElement.className=style.iframeElement.className.replace(style.boxposition[oldPosition],style.boxposition[newPosition]).replace(style.boxclass[oldPosition],style.boxclass[newPosition])}},updateLinks:function(mainUrl,issuesUrl,hasAuthChanged,isOutsideCheckInitiated){if(issuesUrl&&state.issuesLink!=issuesUrl){if(style.issuesCircleContainer){var issuesButton=style.issuesCircleContainer.querySelector('button[data-link="'+state.issuesLink+'"]');if(issuesButton){issuesButton.setAttribute("data-link",issuesUrl);state.issuesLink=issuesUrl}}else{state.issuesLink=issuesUrl}}if(mainUrl&&state.mainLink!=mainUrl){var mainButton=style.containerElement.querySelector('button[data-link="'+state.mainLink+'"]');if(mainButton){mainButton.setAttribute("data-link",mainUrl);state.mainLink=mainUrl}if(!hasAuthChanged&&state.isIframeOpen&&style.iframeElement){if(isOutsideCheckInitiated&&core.extractParameterFromUrl(mainUrl,"url")==core.extractParameterFromUrl(state.mainLink,"url")){return}style.iframeElement.setAttribute("aria-label",texts.regionName);style.iframeElement.src=mainUrl}}},clear:function(){if(state.isShown){style.mainButton.className=style.mainButton.className+" cleared";listeners.removeClick(style.mainButton,style.openDataLinkUrl)}style.clearBottomBoxes();if(state.isIframeOpen){style.closeIframe()}},clearBottomBoxes:function(){if(state.isShown){style.bottomBoxesElement.className=style.bottomBoxesElement.className+" cleared";style.dragElement.className=style.dragElement.className+" cleared"}},unclearBottomBoxes:function(){if(state.isShown){style.bottomBoxesElement.className=style.bottomBoxesElement.className.replace("cleared","");style.dragElement.className=style.dragElement.className.replace("cleared","")}},unclear:function(){if(state.isShown){if(style.bottomBoxesElement){style.bottomBoxesElement.className=style.bottomBoxesElement.className.replace("cleared","")}style.dragElement.className=style.dragElement.className.replace("cleared","");style.mainButton.className=style.mainButton.className.replace("cleared","");listeners.createClick(style.mainButton,style.openDataLinkUrl)}},applyRecheckingView:function(){style.recheckCircle=style.createBadge("si-recheck",style.recheckIcon,texts.recheck,"");style.issuesCircleContainer.replaceChild(style.recheckCircle,style.issuesCircle)},updateIssues:function(wasRechecking,numberOfIssues,label){var issues=style.createBadge("si-issues",numberOfIssues,label,state.issuesLink);if(wasRechecking){style.issuesCircleContainer.replaceChild(issues,style.recheckCircle)}else{style.issuesCircleContainer.replaceChild(issues,style.issuesCircle)}style.issuesCircle=issues},authChange:function(isAuthed,issues,isPageSpecific){core.log("Auth change {0}",isAuthed?"from not authed to authed":"from authed to not authed");while(style.bottomBoxesElement.firstChild){style.bottomBoxesElement.removeChild(style.bottomBoxesElement.firstChild)}style.addBottomBoxContent(style.bottomBoxesElement,isAuthed,issues,isPageSpecific)},contextChange:function(isAuthed,issues,isPageSpecific){core.log("Context change happening - going from {0}",isPageSpecific?"from site to page specific":"from page specific to site");while(style.bottomBoxesElement.firstChild){style.bottomBoxesElement.removeChild(style.bottomBoxesElement.firstChild)}style.addBottomBoxContent(style.bottomBoxesElement,isAuthed,issues,isPageSpecific);if(isPageSpecific){style.unclearBottomBoxes()}else{style.clearBottomBoxes()}},closeIframe:function(){style.containerElement.style.display="";if(style.iframeContainer){style.iframeContainer.style.display="none"}state.isIframeOpen=false},popupNewWindowCenter:function(url,title,width,height){var dualScreenLeft=w.screenLeft!=undefined?w.screenLeft:screen.left;var dualScreenTop=w.screenTop!=undefined?w.screenTop:screen.top;var windowWidth=w.innerWidth?w.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width;var windowHeight=w.innerHeight?w.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height;var left=windowWidth/2-width/2+dualScreenLeft;var top=windowHeight/2-height/2+dualScreenTop;return window.open(url,title,"scrollbars=no,toolbar=no,width="+width+",height="+height+",top="+top+",left="+left)},openDataLinkUrl:function(){var link=this.getAttribute("data-link");if(core.empty(link)){return}style.openSiteimproveLink(link)},openSiteimproveLink:function(link){if(!state.auth){var loginWindow=style.popupNewWindowCenter(link,"Siteimprove Login",580,750);core.handleLoginWindow(loginWindow,state.isFirstPage);return}style.containerElement.style.display="none";state.isIframeOpen=true;if(style.iframeContainer&&style.iframeElement){if(link!=style.iframeElement.src||style.iframeElement.dirty){style.iframeElement.dirty=false;style.iframeElement.setAttribute("aria-label",texts.regionName);style.iframeElement.src=link;state.isPfgListening=false}style.iframeContainer.style.display="";return}style.iframeContainer=style.createDiv("si-iframe-container");style.iframeElement=d.createElement("iframe");style.iframeElement.setAttribute("aria-label",texts.regionName);style.iframeElement.className+="si-iframe-element "+style.boxclass[state.position]+" "+style.boxposition[state.position];if(link!=style.iframeElement.src||style.iframeElement.dirty){state.isPfgListening=false;style.iframeElement.src=link}style.iframeContainer.appendChild(style.iframeElement);d.getElementsByTagName("body")[0].appendChild(style.iframeContainer)},decodePosition:function(position){switch(position){case"West":return"w";case"South":return"s";case"WestSouth":return"ws";case"EastSouth":return"es";default:return"e"}},showSmallBox:function(isAuthed,issues,isPageSpecific){if(state.isShown){return}core.log("Creating elements");var smallBox=style.createSmallBox(isAuthed,issues,isPageSpecific);if(core.empty(smallBox)){core.log("Not showing small box - something went wrong");return}core.log("Showing small box");var styleElement=style.createStyleElement();var size=core.getCookieValue(state.cookie.name);if(size){var sizepx=size+"px";var boxSize=size-style.dragSize;if(style.isSouth(state.position)){style.containerElement.style.height=sizepx;style.boxesElement.style.height=boxSize>=0?boxSize+"px":"0px"}else{style.containerElement.style.width=sizepx;style.boxesElement.style.width=boxSize>=0?boxSize+"px":"0px"}if(size<=10){listeners.removeMouseDown(style.dragElement,style.dragSmallBox);style.dragElement.style.cursor="pointer";listeners.createClick(style.dragElement,style.maximizeSmallBox);state.minimized=true}}d.getElementsByTagName("head")[0].appendChild(styleElement);d.getElementsByTagName("body")[0].appendChild(smallBox);state.isShown=true}};const siteimprovePaths={baseUrl:"https://my2.siteimprove.com",baseUrlUS:"https://my2.us.siteimprove.com",baseDomain:"siteimprove.com",reqPath:"/overlay/cms/cmspage?url=",recheckPath:"/overlay/cms/recheckcmspage?url=",recrawlPath:"/overlay/cms/recrawl?url=",siteReqPath:"/overlay/cms/cmssite?url=",closePath:"/overlay/cms/close"};var accountIsBasedInUs=false;const logCountMax=500;var core={empty:function(e){return e==undefined||e==null||e==""},baseUrl:()=>{if(accountIsBasedInUs)return siteimprovePaths.baseUrlUS;return siteimprovePaths.baseUrl},reqUrl:()=>core.baseUrl()+siteimprovePaths.reqPath,recheckUrl:()=>core.baseUrl()+siteimprovePaths.recheckPath,recrawlUrl:()=>core.baseUrl()+siteimprovePaths.recrawlPath,closeUrl:()=>core.baseUrl()+siteimprovePaths.closePath,siteReqUrl:()=>core.baseUrl()+siteimprovePaths.siteReqPath,pollInterval:1e4,inActivityThreshold:3e5,history:{domain:[],recheck:[],page:[],contentcheck:[],url:"",type:""},rechecked:[],updateUrlHistory:function(type,url){core.history[type].push(url);core.history.url=url;core.history.type=type},extractParameterFromUrl:function(url,parameterName){parameterName=parameterName.toLowerCase();parameterName=parameterName.replace(/[\[\]]/g,"\\$&");url=url.toLowerCase();var regex=new RegExp("[?&]"+parameterName+"(=([^&#]*)|&|#|$)");var results=regex.exec(url);if(!results)return null;if(!results[2])return"";return decodeURIComponent(results[2].replace(/\+/g," "))},fmt:function(){var _a=Array.prototype.slice.call(arguments);var s=_a[0];var a=_a.slice(1);for(var i=0;i<a.length;i++){var reg=new RegExp("\\{"+i+"\\}","gm");s=s.replace(reg,a[i])}return s},getData:function(url,callback){var reqUrl=url+"&token="+state.token;var req=new XMLHttpRequest;req.onreadystatechange=function(){if(req.readyState==4){callback(req.responseText)}};req.withCredentials=true;req.open("GET",reqUrl);req.setRequestHeader("Accept","application/json");core.log("Requesting url {0}",reqUrl);req.send();return req},handleLoginWindow:function(loginWindow,isPageSpecific){state.stopPoll=false;setTimeout(function(){if(!loginWindow.closed){core.handleLoginWindow(loginWindow,isPageSpecific);return}if(!state.requestUrl){return}core.getData(state.requestUrl,function(data){state.isPageSpecific=isPageSpecific;core.updateSmallBoxData(state.requestUrl,data,true,isPageSpecific,function(){if(state.auth){var checked="";if(core.history.type=="recheck"){checked=core.history.url;core.orderRecheck(core.history.url,true)}for(var i=0;i<core.history.recheck.length;i++){var c=core.history.recheck[i];if(!core.empty(c)&&c!=checked&&core.rechecked.indexOf(c)==-1){core.log("Rechecking a url from state - {0}",c);core.orderRecheck(c,false)}}core.history.recheck=[]}})})},100)},orderRecheck:function(url,updateState,callback){var reqUrl=core.recheckUrl()+url;if(state.areRequestsAllowed){core.getData(reqUrl,function(data){core.log("Received data when ordering recheck - {0}",data);try{var parsedData=JSON.parse(data);if(!parsedData.success){core.log("Recheck could not be ordered");return}core.rechecked.push(url);if(updateState){style.unclear();if(!state.isPageSpecific){style.contextChange(true,parsedData.issues,true);state.isPageSpecific=true}core.log("Recheck successfully ordered");if(!state.isRechecking){state.isRechecking=true;style.applyRecheckingView()}state.currentInputtedUrl=url;core.pollInterval=2e3;var pollUrl=core.reqUrl()+url;state.requestUrl=pollUrl;core.poll(pollUrl);if(parsedData.mainUrl&&parsedData.issuesUrl){style.updateLinks(parsedData.mainUrl,parsedData.issuesUrl,false,false)}}if(callback){callback()}}catch(err){core.log("Caught error when ordering recheck. Probably couldnt parse the returned which was not json")}})}},poll:function(url){setTimeout(function(){if(state.requestUrl===url&&!core.isPollAboveThreshold()&&!state.stopPoll){if(!state.minimized){if(state.isIframeOpen||state.auth){if(state.pollRequest){state.pollRequest.abort()}state.pollRequest=core.getData(url,function(data){core.updateSmallBoxData(url,data,false,true)})}}core.poll(url)}},core.pollInterval)},isPollAboveThreshold:function(){var currentTime=new Date;const pollingTime=currentTime-state.pollStartTime;if(pollingTime>core.inActivityThreshold&&!state.isRechecking){return true}else{return false}},updatePage:function(reqUrl,data,initiatePoll,callback){if(!state.isShown){state.issuesLink=data.issuesUrl||state.issuesLink;state.isRechecking=data.recheck;state.issues=data.issues;if(data.error!="None"){core.log("Error finding page in Siteimprove");state.error=true;state.errorReason=data.error.toLowerCase()}style.showSmallBox(state.auth,state.issues,true);style.unclearBottomBoxes();state.isPageSpecific=true;if(initiatePoll){core.poll(reqUrl)}}else{style.unclearBottomBoxes();if(initiatePoll){core.poll(reqUrl)}var newPos=style.decodePosition(data.position);if(state.position!=newPos){style.updateSmallBoxScreenPosition(state.position,newPos);state.position=newPos;core.log("Updating position")}if(!state.auth){style.updateLinks(data.mainUrl,data.issuesUrl,true,data.recheck&&!state.isRechecking);state.auth=true;style.authChange(true,data.issues,true)}else{if(data.mainUrl||data.issuesUrl){style.updateLinks(data.mainUrl,data.issuesUrl,false,data.recheck&&!state.isRechecking)}}if(data.recheck){if(!state.isPageSpecific){style.contextChange(true,data.issues,true);state.isPageSpecific=true}if(!state.isRechecking){state.isRechecking=true;style.applyRecheckingView()}if(callback){callback()}return}else if(state.isRechecking){state.issues=data.issues;state.isRechecking=false;core.pollInterval=1e4;style.updateIssues(true,state.issues,texts.issues);if(callback){callback()}return}if(data.error!="None"){state.errorReason=data.error.toLowerCase();var errorText=state.errorReason=="noaccess"?texts.accessError:texts.notFound;if(!state.isPageSpecific){state.issuesLink=reqUrl+"&token="+state.token;style.contextChange(true,0,true);state.isPageSpecific=true}style.updateIssues(false,"!",errorText);if(callback){callback()}return}if(initiatePoll||data.issues!=state.issues){state.issues=data.issues;if(!state.isPageSpecific){style.contextChange(true,state.issues,true);state.isPageSpecific=true;if(callback){callback()}return}style.updateIssues(false,state.issues,texts.issues)}}if(callback){callback()}},updateSite:function(data,callback){if(!state.isShown){if(data.error!="None"){core.log("Error finding site in Siteimprove");state.error=true;state.errorReason=data.error.toLowerCase()}style.showSmallBox(state.auth,state.issues,false);style.clearBottomBoxes();state.isPageSpecific=false}else{style.clearBottomBoxes();if(state.isPageSpecific){style.contextChange(true,0,false)}state.isPageSpecific=false;state.isRechecking=false;var newPos=style.decodePosition(data.position);if(state.position!=newPos){style.updateSmallBoxScreenPosition(state.position,newPos);state.position=newPos;core.log("Updating position")}if(!state.auth){style.updateLinks(data.mainUrl,state.issuesLink,true,false);state.auth=true;style.authChange(true,data.issues,false)}else{if(data.mainUrl){style.updateLinks(data.mainUrl,state.issuesLink,false,false)}}}if(callback){callback()}},updateSmallBoxData:function(reqUrl,data,initiatePoll,isPageSpecific,callback){if(reqUrl!=state.requestUrl){if(callback){callback()}return}if(core.empty(data)){if(!state.isShown){state.position="e";state.loginLink=core.closeUrl();state.mainLink=core.closeUrl();style.showSmallBox(state.auth,0,isPageSpecific)}if(callback){callback()}return}core.log("Received data - {0}",data);var parsedData;try{parsedData=JSON.parse(data)}catch(err){core.log("Could not parse data as json");if(!state.isShown){core.log("Showing login first time");state.loginLink=core.closeUrl();state.mainLink=core.closeUrl();state.position="e";style.showSmallBox(state.auth,0,isPageSpecific)}style.updateLinks(core.closeUrl(),core.closeUrl(),true,false);state.loginLink=core.closeUrl();state.mainLink=core.closeUrl();if(state.isShown&&state.auth){style.authChange(false,state.issues,isPageSpecific)}state.auth=false;if(state.isIframeOpen){style.closeIframe()}if(callback){callback()}state.areRequestsAllowed=false;style.unclearBottomBoxes();return}if(!parsedData.authed){if(!state.isShown){state.loginLink=core.closeUrl();state.mainLink=core.closeUrl();state.position="e";style.showSmallBox(state.auth,0,true)}style.updateLinks(core.closeUrl(),core.closeUrl(),true,false);state.loginLink=core.closeUrl();state.mainLink=core.closeUrl();if(state.isShown&&state.auth){style.authChange(false,state.issues)}state.auth=false;if(callback){callback()}state.areRequestsAllowed=false;return}if(!state.isShown){texts.update(parsedData.issuesText,parsedData.notFoundText,parsedData.recheckText,parsedData.buttonAriaLabel);state.position=style.decodePosition(parsedData.position);state.mainLink=parsedData.mainUrl;state.auth=true}state.areRequestsAllowed=true;if(parsedData.error!="None"){core.log("Error occured - {0}",parsedData.error);state.errorReason=parsedData.error.toLowerCase();if(state.errorReason=="noaccess"){var tempUrl=reqUrl+"&token="+state.token;state.error=true;if(state.isShown){style.updateLinks(tempUrl,tempUrl,false,isPageSpecific)}else{state.mainLink=tempUrl;state.issuesLink=tempUrl}}}else{state.error=false;state.errorReason=""}if(isPageSpecific){core.updatePage(reqUrl,parsedData,initiatePoll,callback)}else{core.updateSite(parsedData,callback)}},setCookie:function(name,value,expiryValue,domain,path,isSecure){if(typeof value!="undefined"){path=path||"/";if(value===null){value="";expiryValue=-1}var expires="";if(expiryValue&&(typeof expiryValue=="number"||expiryValue.toUTCString)){var date;if(typeof expiryValue=="number"){date=new Date;date.setTime(date.getTime()+expiryValue*24*60*60*1e3)}else{date=expiryValue}expires="; expires="+date.toUTCString()}var pathValue=path?"; path="+path:"; path=/";var domainValue=domain?"; domain="+domain:"";var secure=isSecure?"; secure":"";d.cookie=[name,"=",encodeURIComponent(value),expires,pathValue,domainValue,secure].join("")}},getCookieValue:function(name){var cookieValue=null;if(d.cookie&&d.cookie!==""){var cookies=d.cookie.split(";");for(var i=0;i<cookies.length;i++){var cookie=cookies[i].replace(/^\s+|\s+$/g,"");if(cookie.substring(0,name.length+1)==name+"="){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break}}}return cookieValue},_logqueue:[],_logshown:false,log:function(){if(this._logqueue.length>logCountMax){this._logqueue.shift()}this._logqueue.push({time:Date.now(),type:"msg",msg:Array.prototype.slice.call(arguments)});if(this._logshown)this.showlog()},warn:function(){if(this._logqueue.length>logCountMax){this._logqueue.shift()}this._logqueue.push({time:Date.now(),type:"warn",msg:Array.prototype.slice.call(arguments)});if(this._logshown)this.showlog()},showlog:function(){core._logshown=true;var dw=d.getElementById("sidebugarea");if(dw)dw.parentNode.removeChild(dw);var s="";for(var i=0;i<core._logqueue.length;i++){var o=core._logqueue[i];s+='<p style="padding:8px;margin:0;margin-bottom:8px;background:#'+(o.type=="msg"?"FFF7C9":"ca0000;color:white")+';">'+"["+new Date(o.time).toLocaleTimeString([],{hour12:false})+"] "+(o.type=="warn"?"<b>Warning:</b> ":"")+decodeURIComponent(new String(core.fmt.apply(this,o.msg)).replace(/(&[a-z_]+=|\?)/g,"<br />&nbsp;&nbsp;&nbsp;$1"))+"</p>"}var side="left";if(style.isWest(state.position)){side="right"}var _e,_c;_c=d.createElement("a");_c.href="#";_c.innerHTML="\xd7 Close";_c.style.cssText="display:block;float:right;color:black;text-decoration:none;";_c.onclick=function(e){_e.parentNode.removeChild(_e);core._logshown=false;return false};_e=d.createElement("div");_e.style.cssText="position:fixed;top:10px;"+side+":10px;background:white;border:1px #ccc solid;width:500px;padding:20px;padding-bottom:10px;font-size:12px;font-family:Arial;line-height:135%;max-height:90%;overflow-y:auto;text-align:left;z-index:999999";_e.innerHTML=s;_e.id="sidebugarea";_e.appendChild(_c);d.body.appendChild(_e);_c.scrollIntoView({block:"end"})}};const isUrl=value=>{let url;try{url=new URL(value)}catch(_){return false}return url.protocol==="http:"||url.protocol==="https:"};const cleanUpUrl=value=>{let url;try{url=new URL(value.trim())}catch(_){return""}var regex=/\/$/;return url.toString().replace(regex,"")};var clear=function(callback){style.clear();state.requestUrl="";if(callback){callback()}};var domain=function(url,token,callback){if(state.currentInputtedUrl===url&&!state.isPageSpecific){return}core.log("Got domain - {0}",url);core.updateUrlHistory("domain",url);state.token=token;state.currentInputtedUrl=url;var reqUrl=core.siteReqUrl()+url+"&encodedUrl="+encodeURIComponent(url);state.requestUrl=reqUrl;state.isFirstPage=false;if(state.areRequestsAllowed){core.getData(reqUrl,function(data){style.unclear();core.updateSmallBoxData(reqUrl,data,false,false);if(callback){callback()}})}};var input=function(url,token,callback){if(state.currentInputtedUrl===url&&state.isPageSpecific){return}core.log("Got url - {0}",url);core.updateUrlHistory("page",url);state.token=token;state.currentInputtedUrl=url;var reqUrl=core.reqUrl()+url+"&encodedUrl="+encodeURIComponent(url);state.requestUrl=reqUrl;state.isFirstPage=true;if(state.areRequestsAllowed){core.getData(reqUrl,function(data){core.updateSmallBoxData(reqUrl,data,!core.empty(url),true);state.pollStartTime=new Date;if(core.empty(url)){style.clear()}else{style.unclear()}if(callback){callback()}})}};var recheck=function(url,token,callback){if(core.empty(url)){return}core.log("CMS ordered recheck of url - {0}",url);state.token=token;core.updateUrlHistory("recheck",url);core.orderRecheck(url+"&encodedUrl="+encodeURIComponent(url),true,callback)};var recrawl=function(url,token,callback){if(core.empty(url)){return}core.log("CMS ordered a recrawl of entire site - {0}",url);var reqUrl=core.recrawlUrl()+url+"&encodedUrl="+encodeURIComponent(url);state.token=token;if(state.areRequestsAllowed){core.getData(reqUrl,function(data){try{var j=JSON.parse(data);if(j.success){core.log("Recrawl successfully ordered");if(callback){callback()}}else{core.log("Recrawl could not be ordered - perhaps due to rights issues. Only AccountOwners are allowed to do this")}}catch(err){core.log("Caught error when ordering recrawl. Probably couldnt parse the returned which was not json")}})}};var onHighlight=function(callback){state.highlightCallback=callback};var contentcheckZip=function(content,url,token,callback){var message={si:"contentcheck-zip",data:{content:content}};contentcheckBase(message,url,token,callback)};var contentcheckFlatDom=function(content,url,token,callback){var startTime=performance.now();var flatOMResult=traverse(content);var traversalEndTime=performance.now();var jsonContent=flatOMResult;var docElement=content.documentElement;var width=docElement.clientWidth;var height=docElement.clientHeight;var message={si:"contentcheck-flat-dom",data:{dom:jsonContent.dom,layout:jsonContent.layout,viewportWidth:width,viewportHeight:height,captureTimeMillis:traversalEndTime-startTime}};contentcheckBase(message,url,token,callback)};var contentcheck=function(content,url,token,callback){var message="si:contentcheck:"+JSON.stringify({content:content});contentcheckBase(message,url,token,callback)};var contentcheckBase=function(message,url,token,callback){state.token=token;state.contentCheckCallback=callback;state.publishedPageUrl=url;if(state.timeout){clearTimeout(state.timeout)}var sendMessageWhenReady=function(){if(!state.isPfgListening){state.timeout=setTimeout(sendMessageWhenReady,1e3)}else if(style.iframeElement){var contentWindow=style.iframeElement.contentWindow;if(contentWindow&&contentWindow.postMessage){contentWindow.postMessage(message,core.baseUrl())}}};var sendContent=function(){if(!state.auth){var link=style.mainButton.getAttribute("data-link");var loginWindow=style.popupNewWindowCenter(link,"Siteimprove Login",580,750);core.handleLoginWindow(loginWindow,state.isFirstPage);return}style.iframeContainer=style.createDiv("si-iframe-container");style.iframeElement=d.createElement("iframe");style.iframeElement.setAttribute("aria-label",texts.regionName);style.iframeElement.className+="si-iframe-element "+style.boxclass[state.position]+" "+style.boxposition[state.position];state.isPfgListening=false;style.iframeElement.src=style.mainButton.getAttribute("data-link");style.iframeContainer.style.display="none";style.iframeContainer.appendChild(style.iframeElement);d.getElementsByTagName("body")[0].appendChild(style.iframeContainer);sendMessageWhenReady()};if(state.areRequestsAllowed){if(style.iframeContainer&&style.iframeElement){sendMessageWhenReady()}else if(state.currentInputtedUrl===url&&state.isPageSpecific){sendContent()}else{input(url,token,sendContent)}}};var setConfig=function(config){if(config.baseUrl&&isUrl(config.baseUrl)){const baseUrl=cleanUpUrl(config.baseUrl);siteimprovePaths.baseUrl=baseUrl;core.log("The base URL has been updated to "+baseUrl)}};var funcs={clear:clear,domain:domain,input:input,recheck:recheck,recrawl:recrawl,showlog:core.showlog,contentcheck:contentcheck,"contentcheck-zip":contentcheckZip,"contentcheck-flat-dom":contentcheckFlatDom,onHighlight:onHighlight,setConfig:setConfig};si.push=function(args){var name=args[0];if(name===undefined){return}var fnc=funcs[args[0]];fnc.apply(si,args.slice(1))};for(var i=0;i<si.length;i++){si.push(si[i])}var debounce=function(func,wait){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;func.apply(context,args)};clearTimeout(timeout);timeout=setTimeout(later,wait)}};var displayContentCheckResults=debounce(function(j){var contentId=j.ContentId;core.log("Content check successfully ordered: "+contentId);core.log("Got content ID {0} for url - {1}",contentId,state.publishedPageUrl);core.updateUrlHistory("contentcheck",state.publishedPageUrl);state.currentInputtedUrl=state.publishedPageUrl;var contentCheckResultsUrl=core.reqUrl()+state.publishedPageUrl+"&IsContentCheck=True&ContentCheckId="+contentId;state.requestUrl=contentCheckResultsUrl;state.isFirstPage=true;if(state.contentCheckCallback){state.contentCheckCallback(contentId)}core.getData(contentCheckResultsUrl,function(data){core.updateSmallBoxData(contentCheckResultsUrl,data,true,true);style.openSiteimproveLink(style.mainButton.getAttribute("data-link"))})},100);w.addEventListener("message",function(e){var getEventData=function(data,eventName){if(typeof data==="string"&&data.indexOf(eventName)===0)return data.substring(eventName.length);return null};var origin=e.origin;var baseUrl=core.baseUrl();if(origin&&baseUrl&&origin.endsWith(siteimprovePaths.baseDomain)){if(e.data=="si:logging_out"){core.log("Logging out of siteimprove");core.updateSmallBoxData(state.requestUrl,"<>",false,state.isPageSpecific);state.stopPoll=true;style.closeIframe();return}if(e.data=="si:close_bigbox"){core.log("Closing big box");style.closeIframe();return}if(e.data=="si:logged_out"){core.log("Logged out of siteimprove");state.isPfgListening=false;style.iframeElement.dirty=true;var eventSrc=e.source;setTimeout(function(){eventSrc.close()},500);return}if(e.data=="si:registered"){state.isPfgListening=true;if(origin.startsWith(siteimprovePaths.baseUrlUS)){accountIsBasedInUs=true}return}if(state.highlightCallback){var tempHighlightInfo=getEventData(e.data,"si:highlight:");if(tempHighlightInfo!==null&&tempHighlightInfo!==""){try{var highlightInfo=JSON.parse(tempHighlightInfo);if(typeof highlightInfo==="object"){state.highlightCallback(highlightInfo)}else{var highlightingSelectors={highlights:[{selector:highlightInfo,offset:null}]};state.highlightCallback(highlightingSelectors)}}catch(err){core.log("Caught error ",err," during highlighting ",tempHighlightInfo)}return}}var positionInfo=getEventData(e.data,"si:pos_update:");if(positionInfo){core.log("Changing position");var newPos=style.decodePosition(positionInfo);if(state.position!=newPos){style.updateSmallBoxScreenPosition(state.position,newPos);state.position=newPos;core.log("Updated position")}return}var contentCheckResponse=getEventData(e.data,"si:contentcheck_confirmation:");if(contentCheckResponse){try{var j=JSON.parse(contentCheckResponse);if(!j.Success){core.log("Content check could not be ordered! "+j.Message)}displayContentCheckResults(j)}catch(err){core.log("Caught error ",err," when ordering content check: ",contentCheckResponse)}return}}});si.loaded=true})(window,document,global._si)}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"@siteimprove/flat-object-model-capture/dist":1}]},{},[4]);